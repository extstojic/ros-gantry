<?xml version="1.0"?>
<launch>
	<arg name="min_x" default="-0.4"/>
	<arg name="max_x" default="0.4"/>
	<arg name="min_y" default="-0.3"/>
	<arg name="max_y" default="0.3"/>
	<arg name="min_z" default="-0.5"/>
	<arg name="max_z" default="0.5"/>
	<arg name="max_speed" default="0.2"/>

	<!-- Clear previous robot params -->
	<rosparam command="delete" param="robot_config" />
	<rosparam command="delete" param="robot_description" />

	<!-- Load URDF robot model -->
	<param name="robot_description" command="$(find xacro)/xacro '$(find dnb_gantry_simulator)/urdf/gantry.urdf'"/>

	<!-- Load the robot config -->
	<rosparam file="$(find dnb_gantry_simulator)/module_config/robot/gantry.yaml" command="load" ns="robot_config" />

	<!-- Gantry Simulator Node -->
	<node name="dnb_gantry_simulator" pkg="dnb_gantry_simulator" type="dnb_gantry_simulator_node" output="screen">
		<param name="min_x" value="$(arg min_x)"/>
		<param name="max_x" value="$(arg max_x)"/>
		<param name="min_y" value="$(arg min_y)"/>
		<param name="max_y" value="$(arg max_y)"/>
		<param name="min_z" value="$(arg min_z)"/>
		<param name="max_z" value="$(arg max_z)"/>
		<param name="max_speed" value="$(arg max_speed)"/>
	</node>

	<!-- Robot state publisher -->
	<node name="robot_state_publisher" pkg="robot_state_publisher" type="robot_state_publisher" output="screen"/>

	<!-- Joint state publisher - source from simulator joint states -->
	<node name="joint_state_publisher" pkg="joint_state_publisher" type="joint_state_publisher" output="screen">
		<param name="use_gui" value="false"/>
		<rosparam param="source_list">[/dnb_gantry_simulator/joint_states]</rosparam>
	</node>

	<!-- world to robot_base static transform publisher -->
	<node args="0 0 0 0 0 0 /world /robot_base 100" name="stfp_world_to_robot_base" pkg="tf" type="static_transform_publisher"/>

	<!-- robot_base to base_link static transform publisher (like nachi driver) -->
	<node args="0 0 0 0 0 0 /robot_base /base_link 100" name="stfp_robot_base_to_base_link" pkg="tf" type="static_transform_publisher"/>

	<!-- Start remote robot control node (provides jog services etc) -->
	<include file="$(find dnb_remote_robot_control)/launch/start_v3.launch">
		<arg name="package" value="dnb_gantry_simulator"/>
		<arg name="robot" value="gantry"/>
	</include>

	<!-- Notify robot start -->
	<include file="$(find robot_movement_interface)/launch/notify_robot_start.launch"/>
</launch>
